<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<!--NewPage-->
<html>
<head>
<!-- Generated by javadoc on Thu Jun 05 11:02:50 PDT 1997 -->
<title>
  Class ec.transform.coverage.CoverageMonitor
</title>
</head>
<body>
<a name="_top_"></a>
<pre>
<a href="packages.html">All Packages</a>  <a href="tree.html">Class Hierarchy</a>  <a href="Package-ec.transform.coverage.html">This Package</a>  <a href="ec.transform.coverage.Application.html#_top_">Previous</a>  <a href="ec.transform.coverage.ECovPoint.html#_top_">Next</a>  <a href="AllNames.html">Index</a></pre>
<hr>
<h1>
  Class ec.transform.coverage.CoverageMonitor
</h1>
<pre>
java.lang.Object
   |
   +----ec.transform.coverage.CoverageMonitor
</pre>
<hr>
<dl>
  <dt> public class <b>CoverageMonitor</b>
  <dt> extends Object
</dl>
This static class controls the instrumentation of, and records coverage
 for, other classes.  It is part of the runtime image of your program.
 See <a href="ecov.html">the user's manual</a> for more information.
 The CoverageMonitor monitors three things:  which classes should be
 instrumented, which in-core classes *are* instrumented, and logging.
<p>
<hr>
<a name="index"></a>
<h2>
  <img src="images/constructor-index.gif" width=275 height=38 alt="Constructor Index">
</h2>
<dl>
  <dt> <img src="images/yellow-ball-small.gif" width=6 height=6 alt=" o ">
	<a href="#CoverageMonitor()"><b>CoverageMonitor</b></a>()
  <dd> 
</dl>
<h2>
  <img src="images/method-index.gif" width=207 height=38 alt="Method Index">
</h2>
<dl>
  <dt> <img src="images/green-ball-small.gif" width=6 height=6 alt=" o ">
	<a href="#classFinalize()"><b>classFinalize</b></a>()
  <dd>  Ensures that the log file is written.
  <dt> <img src="images/green-ball-small.gif" width=6 height=6 alt=" o ">
	<a href="#clearInCoreLog()"><b>clearInCoreLog</b></a>()
  <dd> 
 Clear the coverage log.
  <dt> <img src="images/green-ball-small.gif" width=6 height=6 alt=" o ">
	<a href="#on()"><b>on</b></a>()
  <dd>  Call to determine if coverage is being monitored.
  <dt> <img src="images/green-ball-small.gif" width=6 height=6 alt=" o ">
	<a href="#parseControl(java.io.File)"><b>parseControl</b></a>(File)
  <dd>  Parse control instructions from a File.
  <dt> <img src="images/green-ball-small.gif" width=6 height=6 alt=" o ">
	<a href="#parseControl(java.io.InputStream)"><b>parseControl</b></a>(InputStream)
  <dd>  Parse control instructions from an InputStream.
  <dt> <img src="images/green-ball-small.gif" width=6 height=6 alt=" o ">
	<a href="#parseControl(java.io.StreamTokenizer)"><b>parseControl</b></a>(StreamTokenizer)
  <dd> 
  <dt> <img src="images/green-ball-small.gif" width=6 height=6 alt=" o ">
	<a href="#register(java.lang.String, java.lang.String, java.lang.String, java.lang.String, java.lang.String, int, ec.transform.coverage.ECovPoint[])"><b>register</b></a>(String, String, String, String, String, int, ECovPoint[])
  <dd>  Register a class's static information, which notifies us that it
 is instrumented.
  <dt> <img src="images/green-ball-small.gif" width=6 height=6 alt=" o ">
	<a href="#resetController()"><b>resetController</b></a>()
  <dd>  Reset that part of the coverage monitor state that's created
 from the control file.
  <dt> <img src="images/green-ball-small.gif" width=6 height=6 alt=" o ">
	<a href="#saveInCoreLog()"><b>saveInCoreLog</b></a>()
  <dd> 
 Write the coverage log into a predetermined file.
  <dt> <img src="images/green-ball-small.gif" width=6 height=6 alt=" o ">
	<a href="#saveInCoreLog(java.io.File)"><b>saveInCoreLog</b></a>(File)
  <dd>  Write the coverage log into the named pathname.
  <dt> <img src="images/green-ball-small.gif" width=6 height=6 alt=" o ">
	<a href="#saveInCoreLog(java.lang.String)"><b>saveInCoreLog</b></a>(String)
  <dd>  Like saveInCoreLog(File), except takes a String that is converted
 into a File.
  <dt> <img src="images/green-ball-small.gif" width=6 height=6 alt=" o ">
	<a href="#setInCoreLog(java.lang.String, int[])"><b>setInCoreLog</b></a>(String, int[])
  <dd>  Use to inform the coverage monitor where the coverage log
 (in-core version) for a given class lives.
  <dt> <img src="images/green-ball-small.gif" width=6 height=6 alt=" o ">
	<a href="#setLogfile(java.io.File)"><b>setLogfile</b></a>(File)
  <dd> 
 Set the logfile in which coverage is stored.
  <dt> <img src="images/green-ball-small.gif" width=6 height=6 alt=" o ">
	<a href="#setLogfile(java.lang.String)"><b>setLogfile</b></a>(String)
  <dd>  Like setLogfile(File), except takes a String that is converted
 into a File.
  <dt> <img src="images/green-ball-small.gif" width=6 height=6 alt=" o ">
	<a href="#shouldInstrument(java.lang.String)"><b>shouldInstrument</b></a>(String)
  <dd> 
 Call this method to query if a class should be instrumented.
  <dt> <img src="images/green-ball-small.gif" width=6 height=6 alt=" o ">
	<a href="#toStringStatic()"><b>toStringStatic</b></a>()
  <dd>  Convert the current state of the CoverageMonitor to a string.
</dl>
<a name="constructors"></a>
<h2>
  <img src="images/constructors.gif" width=231 height=38 alt="Constructors">
</h2>
<a name="CoverageMonitor"></a>
<a name="CoverageMonitor()"><img src="images/yellow-ball.gif" width=12 height=12 alt=" o "></a>
<b>CoverageMonitor</b>
<pre>
 public CoverageMonitor()
</pre>
<a name="methods"></a>
<h2>
  <img src="images/methods.gif" width=151 height=38 alt="Methods">
</h2>
<a name="resetController()"><img src="images/green-ball.gif" width=12 height=12 alt=" o "></a>
<a name="resetController"><b>resetController</b></a>
<pre>
 public static void resetController()
</pre>
<dl>
  <dd> Reset that part of the coverage monitor state that's created
 from the control file.  Normally, this is called exactly once.
 Control file testing calls it multiple times.  Normal user code
 should avoid it.
<p>
</dl>
<a name="parseControl(java.io.File)"><img src="images/green-ball.gif" width=12 height=12 alt=" o "></a>
<a name="parseControl"><b>parseControl</b></a>
<pre>
 public static void parseControl(File input) throws IOException, <a href="ec.transform.coverage.ECovControlFormatError.html#_top_">ECovControlFormatError</a>
</pre>
<dl>
  <dd> Parse control instructions from a File.
 See <a href="ecov.html">the user's manual</a> for information
 about their format.
 <p> This routine also turns the coverage monitor on.
 <p> This routine should only be called once.  Additional calls are 
 ignored (in this version).
<p>
  <dd><dl>
    <dt> <b>Parameters:</b>
    <dd> input - The control instructions, typically a stream pointing
            at a file.
    <dt> <b>Throws:</b> IOException
    <dd> Something has gone wrong while reading the
                control file.
    <dt> <b>Throws:</b> <a href="ec.transform.coverage.ECovControlFormatError.html#_top_">ECovControlFormatError</a>
    <dd> Syntax error in the control
                    instructions.
  </dl></dd>
</dl>
<a name="parseControl(java.io.InputStream)"><img src="images/green-ball.gif" width=12 height=12 alt=" o "></a>
<a name="parseControl"><b>parseControl</b></a>
<pre>
 public static void parseControl(InputStream input) throws IOException, <a href="ec.transform.coverage.ECovControlFormatError.html#_top_">ECovControlFormatError</a>
</pre>
<dl>
  <dd> Parse control instructions from an InputStream.  The interface is
 the same as parseControl(File).
<p>
</dl>
<a name="parseControl(java.io.StreamTokenizer)"><img src="images/green-ball.gif" width=12 height=12 alt=" o "></a>
<a name="parseControl"><b>parseControl</b></a>
<pre>
 public static void parseControl(StreamTokenizer input) throws IOException, <a href="ec.transform.coverage.ECovControlFormatError.html#_top_">ECovControlFormatError</a>
</pre>
<a name="shouldInstrument(java.lang.String)"><img src="images/green-ball.gif" width=12 height=12 alt=" o "></a>
<a name="shouldInstrument"><b>shouldInstrument</b></a>
<pre>
 public static boolean shouldInstrument(String aClass) throws Error
</pre>
<dl>
  <dd> Call this method to query if a class should be instrumented.
 Note that the argument is a proper,
 fully-qualified name.  It should not contain a '*'.  This code
 does not check for violations of the last two sentences; it will
 just give the wrong answer.  (Note that a class name in the
 "unnamed" class is "fully qualified" and will match correctly.)
<p>
  <dd><dl>
    <dt> <b>Parameters:</b>
    <dd> aClass - The fully qualified class name to check.
    <dt> <b>Throws:</b> Error
    <dd> It is a program error for 'aClass' to be a
               syntactically incorrect class name.
  </dl></dd>
</dl>
<a name="register(java.lang.String, java.lang.String, java.lang.String, java.lang.String, java.lang.String, int, ec.transform.coverage.ECovPoint[])"><img src="images/green-ball.gif" width=12 height=12 alt=" o "></a>
<a name="register"><b>register</b></a>
<pre>
 public static void register(String aHumanName,
                             String anActualName,
                             String aDisplayHint,
                             String aSourceFile,
                             String aCompiler,
                             int aChecksum,
                             <a href="ec.transform.coverage.ECovPoint.html#_top_">ECovPoint</a> somePoints[]) throws Error
</pre>
<dl>
  <dd> Register a class's static information, which notifies us that it
 is instrumented. 
 It is a caller program error to register the same class more than once.
 The coverage monitor is also turned on.
<p>
  <dd><dl>
    <dt> <b>Parameters:</b>
    <dd> aHumanName - a human-understandable classname to register
    <dd> anActualName - the name the compiler used.
    <dd> aDisplayHint - currently unused.
    <dd> aSourceFile - the sourcefile this class originated in.
    <dd> aCompiler - the compiler that created the class.
    <dd> aChecksum - its checksum
    <dd> somePoints - the individual instrumentation points
    <dt> <b>Throws:</b> Error
    <dd> thrown when class is registered more than once.
  </dl></dd>
</dl>
<a name="setInCoreLog(java.lang.String, int[])"><img src="images/green-ball.gif" width=12 height=12 alt=" o "></a>
<a name="setInCoreLog"><b>setInCoreLog</b></a>
<pre>
 public static void setInCoreLog(String aClass,
                                 int anInCoreLog[]) throws Error
</pre>
<dl>
  <dd> Use to inform the coverage monitor where the coverage log
 (in-core version) for a given class lives.
 Calls made when coverage is not turned on are ignored.
<p>
  <dd><dl>
    <dt> <b>Parameters:</b>
    <dd> aClass - The class this log applies to.
    <dd> anInCoreLog - The log itself.
    <dt> <b>Throws:</b> Error
    <dd> Thrown if the class has not previously been registered.
  </dl></dd>
</dl>
<a name="clearInCoreLog()"><img src="images/green-ball.gif" width=12 height=12 alt=" o "></a>
<a name="clearInCoreLog"><b>clearInCoreLog</b></a>
<pre>
 public static void clearInCoreLog()
</pre>
<dl>
  <dd> Clear the coverage log.  The coverage monitor forgets about all
 coverage recorded to date.  All registered classes are affected.
 Calls made when coverage is not turned on are ignored.
<p>
</dl>
<a name="setLogfile(java.io.File)"><img src="images/green-ball.gif" width=12 height=12 alt=" o "></a>
<a name="setLogfile"><b>setLogfile</b></a>
<pre>
 public static void setLogfile(File aPathname)
</pre>
<dl>
  <dd> Set the logfile in which coverage is stored.
 Calls made when coverage is not turned on are ignored.
<p>
  <dd><dl>
    <dt> <b>Parameters:</b>
    <dd> aPathname - The pathname to be used.  Validity is not checked
            until the logfile is used.
  </dl></dd>
</dl>
<a name="setLogfile(java.lang.String)"><img src="images/green-ball.gif" width=12 height=12 alt=" o "></a>
<a name="setLogfile"><b>setLogfile</b></a>
<pre>
 public static void setLogfile(String aPathname)
</pre>
<dl>
  <dd> Like setLogfile(File), except takes a String that is converted
 into a File.
<p>
</dl>
<a name="saveInCoreLog()"><img src="images/green-ball.gif" width=12 height=12 alt=" o "></a>
<a name="saveInCoreLog"><b>saveInCoreLog</b></a>
<pre>
 public static void saveInCoreLog() throws <a href="ec.transform.coverage.ECovUnwriteableLogFile.html#_top_">ECovUnwriteableLogFile</a>, <a href="ec.transform.coverage.ECovUnreadableLogFile.html#_top_">ECovUnreadableLogFile</a>, <a href="ec.transform.coverage.ECovBogusLogFile.html#_top_">ECovBogusLogFile</a>, <a href="ec.transform.coverage.ECovClassVersionMismatch.html#_top_">ECovClassVersionMismatch</a>
</pre>
<dl>
  <dd> Write the coverage log into a predetermined file.  Contents that already
 exist are updated, not overwritten.  After the log is written, it is 
 zeroed, as if <tt>clearInCoreLog</tt> had been called.  This behavior
 makes it convenient both for each test to have its own log and also
 for a series of tests to accumulate to the same log. 
 <p>Calls made when coverage is not turned on are ignored.</p>
 <p>Note:  there is no thread synchronization, so coverage recorded
 by another thread while this routine is running may be lost.</p>
 <p>Logfiles are currently not locked, 
 so two processes using the same logfile can stomp on each other.</p>
<p>
  <dd><dl>
    <dt> <b>Throws:</b> <a href="ec.transform.coverage.ECovUnwriteableLogFile.html#_top_">ECovUnwriteableLogFile</a>
    <dd> Either the logfile could not be
                    written, or it does not exist and 
                    could not be created.
    <dt> <b>Throws:</b> <a href="ec.transform.coverage.ECovUnreadableLogFile.html#_top_">ECovUnreadableLogFile</a>
    <dd> The logfile, if it exists, must be
                    readable.  If it's not, this exception
                    is thrown.
    <dt> <b>Throws:</b> <a href="ec.transform.coverage.ECovBogusLogFile.html#_top_">ECovBogusLogFile</a>
    <dd> An attempt was made to write
                    to an existing file that is
                    not an Ecov log file.  The
                    file is left unchanged.
    <dt> <b>Throws:</b> <a href="ec.transform.coverage.ECovClassVersionMismatch.html#_top_">ECovClassVersionMismatch</a>
    <dd> When the attempt was made to update
                    existing contents, at least one of the 
                    classes there was discovered to be
                    of a different version than an 
                    executing class.  Use 
                    <tt>getMessage</tt> to
                    find the class's name.  The
                    file is left unchanged.
  </dl></dd>
</dl>
<a name="saveInCoreLog(java.io.File)"><img src="images/green-ball.gif" width=12 height=12 alt=" o "></a>
<a name="saveInCoreLog"><b>saveInCoreLog</b></a>
<pre>
 public static void saveInCoreLog(File pathname) throws <a href="ec.transform.coverage.ECovUnwriteableLogFile.html#_top_">ECovUnwriteableLogFile</a>, <a href="ec.transform.coverage.ECovUnreadableLogFile.html#_top_">ECovUnreadableLogFile</a>, <a href="ec.transform.coverage.ECovBogusLogFile.html#_top_">ECovBogusLogFile</a>, <a href="ec.transform.coverage.ECovClassVersionMismatch.html#_top_">ECovClassVersionMismatch</a>
</pre>
<dl>
  <dd> Write the coverage log into the named pathname.  Behavior is
 otherwise the
 same as <tt>saveInCoreLog()</tt>
<p>
  <dd><dl>
    <dt> <b>Parameters:</b>
    <dd> pathname - The pathname of the file to write.  Later
            calls to saveInCoreLog(with no arguments) will
            also use this name.
  </dl></dd>
</dl>
<a name="saveInCoreLog(java.lang.String)"><img src="images/green-ball.gif" width=12 height=12 alt=" o "></a>
<a name="saveInCoreLog"><b>saveInCoreLog</b></a>
<pre>
 public static void saveInCoreLog(String aPathname) throws <a href="ec.transform.coverage.ECovUnwriteableLogFile.html#_top_">ECovUnwriteableLogFile</a>, <a href="ec.transform.coverage.ECovUnreadableLogFile.html#_top_">ECovUnreadableLogFile</a>, <a href="ec.transform.coverage.ECovBogusLogFile.html#_top_">ECovBogusLogFile</a>, <a href="ec.transform.coverage.ECovClassVersionMismatch.html#_top_">ECovClassVersionMismatch</a>
</pre>
<dl>
  <dd> Like saveInCoreLog(File), except takes a String that is converted
 into a File.
<p>
</dl>
<a name="classFinalize()"><img src="images/green-ball.gif" width=12 height=12 alt=" o "></a>
<a name="classFinalize"><b>classFinalize</b></a>
<pre>
 public static void classFinalize()
</pre>
<dl>
  <dd> Ensures that the log file is written.  When coverage is turned on,
 the monitor calls <tt>System.runFinalizersOnExit</tt> to ensure
 that finalizers are called.  This finalizer writes the log file
 by calling <tt>saveInCoreLog</tt>.
<p>
</dl>
<a name="on()"><img src="images/green-ball.gif" width=12 height=12 alt=" o "></a>
<a name="on"><b>on</b></a>
<pre>
 public static boolean on()
</pre>
<dl>
  <dd> Call to determine if coverage is being monitored.
 This method will initially return false.  It will return true 
 after <tt>parseControl</tt> is called.
<p>
</dl>
<a name="toStringStatic()"><img src="images/green-ball.gif" width=12 height=12 alt=" o "></a>
<a name="toStringStatic"><b>toStringStatic</b></a>
<pre>
 public static String toStringStatic()
</pre>
<dl>
  <dd> Convert the current state of the CoverageMonitor to a string.
 Used for testing and debugging.  Note that the method is static.
<p>
</dl>
<hr>
<pre>
<a href="packages.html">All Packages</a>  <a href="tree.html">Class Hierarchy</a>  <a href="Package-ec.transform.coverage.html">This Package</a>  <a href="ec.transform.coverage.Application.html#_top_">Previous</a>  <a href="ec.transform.coverage.ECovPoint.html#_top_">Next</a>  <a href="AllNames.html">Index</a></pre>
</body>
</html>
