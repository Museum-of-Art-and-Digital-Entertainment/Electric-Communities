<!--NewPage-->
<html>
<head>
<!-- Generated by javadoc on Mon Apr 07 05:23:41 PDT 1997 -->
<a name="_top_"></a>
<title>
  Class ec.e.quake.Tether
</title>
</head>
<body>
<pre>
<a href="packages.html">All Packages</a>  <a href="tree.html">Class Hierarchy</a>  <a href="Package-ec.e.quake.html">This Package</a>  <a href="ec.e.quake.SimplySturdyTether.html#_top_">Previous</a>  <a href="ec.e.quake.TimeQuake.html#_top_">Next</a>  <a href="AllNames.html">Index</a></pre>
<hr>
<h1>
  Class ec.e.quake.Tether
</h1>
<pre>
<a href="java.lang.Object.html#_top_">java.lang.Object</a>
   |
   +----ec.e.quake.Tether
</pre>
<hr>
<dl>
  <dt> public class <b>Tether</b>
  <dt> extends <a href="java.lang.Object.html#_top_">Object</a>
</dl>
A Tether is an object which represents in one objectspace an
object in another objectspace. For example, a RootHolder is a
Tether that represents an in-Vat root to an outer Java
environment. <p>
Tethers are the Stewards that represent the defining boundary of a
Vat.  Stewards can see both Guests and Crew, and can access
dangerous Java services.  Therefore, they must preserve delicate
correctness properties, so there must be very few of them.  Tethers
know the Vat that they collectively define.  They come in two
flavors, root-holders and leafs. <p>
A Leaf holds onto 'held' without causing it to be e-reachable from
the Leaf, since typically 'held' will be an out-of-vat
object. Leafs are the Tethers that may directly refer to Crew, as
well as to dangerous Java services. <p>
These pre-EVM Tethers are loosely based on evm1/ec/util/Tether.java
(Thanks Dan!) <p>
<dl>
    <dt> <b>See Also:</b>
    <dd> <a href="ec.e.quake.Vat.html#makeSturdyLeaf">makeSturdyLeaf</a>
</dl>
<hr>
<a name="index"></a>
<h2>
  <img src="images/variable-index.gif" width=207 height=38 alt="Variable Index">
</h2>
<dl>
  <dt> <img src="images/magenta-ball-small.gif" width=6 height=6 alt=" o ">
	<a href="#myHeld"><b>myHeld</b></a>
  <dd> 
  <dt> <img src="images/blue-ball-small.gif" width=6 height=6 alt=" o ">
	<a href="#TYPE"><b>TYPE</b></a>
  <dd> 
</dl>
<h2>
  <img src="images/constructor-index.gif" width=275 height=38 alt="Constructor Index">
</h2>
<dl>
  <dt> <img src="images/yellow-ball-small.gif" width=6 height=6 alt=" o ">
	<a href="#Tether(ec.e.quake.Vat, java.lang.Object)"><b>Tether</b></a>(Vat, Object)
  <dd> Construct the Tether to be on the boundary of 'vat'

</dl>
<h2>
  <img src="images/method-index.gif" width=207 height=38 alt="Method Index">
</h2>
<dl>
  <dt> <img src="images/red-ball-small.gif" width=6 height=6 alt=" o ">
	<a href="#birthQuake()"><b>birthQuake</b></a>()
  <dd> What was the quakeCount() (the number of quakes that have
already occurred) at the time this Tether was born?

  <dt> <img src="images/red-ball-small.gif" width=6 height=6 alt=" o ">
	<a href="#held()"><b>held</b></a>()
  <dd> 
Returns the value held by this Tether.
  <dt> <img src="images/red-ball-small.gif" width=6 height=6 alt=" o ">
	<a href="#reconstructed()"><b>reconstructed</b></a>()
  <dd> If held() is called on a smashed Tether, it calls
reconstructed().
  <dt> <img src="images/red-ball-small.gif" width=6 height=6 alt=" o ">
	<a href="#smash()"><b>smash</b></a>()
  <dd> Smashes the Tether and frees 'myHeld' (to enable the
PerishableDataHolder's CacheManager to reclaim memory).
  <dt> <img src="images/red-ball-small.gif" width=6 height=6 alt=" o ">
	<a href="#vat()"><b>vat</b></a>()
  <dd> What's the vat of this Tether?

  <dt> <img src="images/red-ball-small.gif" width=6 height=6 alt=" o ">
	<a href="#vatLock()"><b>vatLock</b></a>()
  <dd> 
This is the one and only lock for synchronizing between the
vat and the outside world.
</dl>
<a name="variables"></a>
<h2>
  <img src="images/variables.gif" width=153 height=38 alt="Variables">
</h2>
<a name="myHeld"><img src="images/magenta-ball.gif" width=12 height=12 alt=" o "></a>
<b>myHeld</b>
<pre>
  protected transient <a href="java.lang.Object.html#_top_">Object</a> myHeld
</pre>
<a name="TYPE"><img src="images/blue-ball.gif" width=12 height=12 alt=" o "></a>
<b>TYPE</b>
<pre>
  public final static <a href="java.lang.Class.html#_top_">Class</a> TYPE
</pre>
<a name="constructors"></a>
<h2>
  <img src="images/constructors.gif" width=231 height=38 alt="Constructors">
</h2>
<a name="Tether"></a>
<a name="Tether(ec.e.quake.Vat, java.lang.Object)"><img src="images/yellow-ball.gif" width=12 height=12 alt=" o "></a>
<b>Tether</b>
<pre>
  public Tether(<a href="ec.e.quake.Vat.html#_top_">Vat</a> vat,
                <a href="java.lang.Object.html#_top_">Object</a> held)
</pre>
<dl>
  <dd> Construct the Tether to be on the boundary of 'vat'
</dl>
<a name="methods"></a>
<h2>
  <img src="images/methods.gif" width=151 height=38 alt="Methods">
</h2>
<a name="vat()"><img src="images/red-ball.gif" width=12 height=12 alt=" o "></a>
<a name="vat"><b>vat</b></a>
<pre>
  public <a href="ec.e.quake.Vat.html#_top_">Vat</a> vat()
</pre>
<dl>
  <dd> What's the vat of this Tether?
</dl>
<a name="vatLock()"><img src="images/red-ball.gif" width=12 height=12 alt=" o "></a>
<a name="vatLock"><b>vatLock</b></a>
<pre>
  public <a href="java.lang.Object.html#_top_">Object</a> vatLock()
</pre>
<dl>
  <dd> This is the one and only lock for synchronizing between the
vat and the outside world.  This is only yielded by the ERunQ
at bracepoints.
</dl>
<a name="birthQuake()"><img src="images/red-ball.gif" width=12 height=12 alt=" o "></a>
<a name="birthQuake"><b>birthQuake</b></a>
<pre>
  protected long birthQuake()
</pre>
<dl>
  <dd> What was the quakeCount() (the number of quakes that have
already occurred) at the time this Tether was born?
</dl>
<a name="reconstructed()"><img src="images/red-ball.gif" width=12 height=12 alt=" o "></a>
<a name="reconstructed"><b>reconstructed</b></a>
<pre>
  protected <a href="java.lang.Object.html#_top_">Object</a> reconstructed() throws <a href="ec.e.quake.SmashedException.html#_top_">SmashedException</a>
</pre>
<dl>
  <dd> If held() is called on a smashed Tether, it calls
reconstructed().  If reconstructed() returns an object, this
becomes the newly held object of the newly non-smashed Tether,
and the smashed state is not visible to the Tether's user.
Such a Tether is "sturdy".  If reconstructed() always returns
'myHeld', then the Tether is unaffected by quakes and so is
"simply sturdy".  <p>
The default behavior of reconstructed() is to throw a
SmashedException, which propogates to held()'s caller.  A
Tether inheriting this behavior is "fragile".
</dl>
<a name="held()"><img src="images/red-ball.gif" width=12 height=12 alt=" o "></a>
<a name="held"><b>held</b></a>
<pre>
  public <a href="java.lang.Object.html#_top_">Object</a> held() throws <a href="ec.e.quake.SmashedException.html#_top_">SmashedException</a>
</pre>
<dl>
  <dd> Returns the value held by this Tether.  Yes, this is public
and should ONLY BE USED VERY CAREFULLY.  In particular, the
value should not be held on the other side of the vat boundary
anytime an E bracepoint is possible. <p>
If the Tether is a Leaf, this means that the value returned by
held() should not be stored, and should evaporate at the end of
the method.  If the Tether is a root-holder, then the pattern
should be: <p>
<pre>
        Tether t = //...
        synchronized(t.vatLock()) {
            ... t.held() ...
        }
</pre> 
where the value from 't.held()' evaporates at the end of the
synchronized block. <p>
A Tether gets smashed in a quake, but whether this is visible
depends on the Tether's reconstructed() method.
  <dl>
    <dt> <b>See Also:</b>
    <dd> <a href="#reconstructed">reconstructed</a>
  </dl>
</dl>
<a name="smash()"><img src="images/red-ball.gif" width=12 height=12 alt=" o "></a>
<a name="smash"><b>smash</b></a>
<pre>
  protected void smash()
</pre>
<dl>
  <dd> Smashes the Tether and frees 'myHeld' (to enable the
PerishableDataHolder's CacheManager to reclaim memory).
Tethers intended to be simply sturdy should override this to do
nothing, in order to not lose 'myHeld'.
</dl>
<hr>
<pre>
<a href="packages.html">All Packages</a>  <a href="tree.html">Class Hierarchy</a>  <a href="Package-ec.e.quake.html">This Package</a>  <a href="ec.e.quake.SimplySturdyTether.html#_top_">Previous</a>  <a href="ec.e.quake.TimeQuake.html#_top_">Next</a>  <a href="AllNames.html">Index</a></pre>
</body>
</html>
