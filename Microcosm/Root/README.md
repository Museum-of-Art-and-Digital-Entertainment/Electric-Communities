What follows is exerpts from EC-Habitats/www-int/engineering/OldStuff/tools/build-environment/Overview.html describing environment setup and the structure of this repository subtree.

## Build Environment Overview

This page gives an overview of the build environment, the directory structure it sets up on your disk and the common make targets.

## Aims Of The Build Environment

The HabiFoo application, together with E, Pluribus and various supporting libraries, make up a very complex system. Few people, if any, understand all the different parts of the system, or even what all the parts are and how they fit together.
The first aim of the build environment - a collection of tools and makefiles - is to provide a simple way to build and run this complex system. In our previous build environment few people new how to build a system from scratch (e.g. how to build ecomp and then build with that ecomp) and fewer still knew how to produce a release, with all the necessary files packaged in a single directory. The new build environment allows anyone to do both.

A second important aim of the build environment is to separate sources and generated files. All sources are under CVS control. No generated files are (with an exception that we'll see later). This means that we can reproduce any release from the CVS history because everything that went into producing that release is under CVS control.

Note that the definition of source is anything that is input to the build process (i.e. isn't generated by the build process). Our Java, E and Pluribus sources are an obvious example. But we also include media (realm text files, images) and third party software (java, the AnyChannel renderer) in this category. They are all needed to reproduce a release.

Some things that might seem like source aren't. For example the unit files produced by the Pluribus compiler are text files and are, in some sense, E source. But to the build environment they are generated files; they are derived from the Pluribus source and do not need to be under CVS control.

## The Directory Structure
The build environment uses the following directory structure

\EC
	This directory contains the build environment tools (cvs, 4NT, bash, the GNU tools, the Java compiler etc.) plus other libraries and support files needed to build the system (e.g. environment bat files, Java standard classes, the AnyChannel renderer). It has two important subdirectories, described below.

\EC\TP
	TP stands for Third Party. This subdirectory of \EC contains third party software that we rely on and that needs to be shipped with our release e.g. Java, the AnyChannel renderer, VoxWare. It does not include third party tools such as make which we use when we build but don't ship in a release. Third party software in this directory should be organized in subdirectories and must be marked with a version number (e.g. java-1.1.3). The version number is important so that we can reconstruct specific releases; e.g. if Microcosm version X was constructed with Java version 1.1.3 we need that to be explicit in the checked in environment files that correspond to Microcosm version X.

\EC\FP
	FP stands for First Party. This subdirectory contains pre-built version of our own software e.g. the E and Pluribus compilers, the E and Pluribus runtime, the HabiFoo classes and their supporting libraries. These files are the one exception to the "no generated files under CVS" rule. They are kept in \EC as a convenience for developers who want to build just the part of the system they've changed, not the entire tree. For example, developers who never work outside of HabiFoo can just build HabiFoo and use the E and Pluribus that come in \EC\FP.

\src
	This directory contains the Java, C/C++, E and Pluribus sources for E, Pluribus and HabiFoo. E, Pluribus and some support libraries are in subdirectory \src\ec3. The HabiFoo application is in subdirectory \src\cosm1. There are some scripts and supporting files (e.g. prop files) to do with running HabiFoo in \src\cosm1\start.

\media
	This directory contains all the artwork, realm and catalog files used by the HabiFoo application. Much of the artwork is bundled up into a repository before it is used by HabiFoo - but the repository is a generated file so it is not checked in.

\Build
	This directory is used to store generated files during the build process. It also has a special subdirectory, \Build\Release, which is described below. Note that generated files should always end up somewhere in \Build. Conversely \Build does not contain any source files (though it may contain copies of source files, generated during the build process). \Build is not under CVS control and can be safely deleted (in fact it's common practice to delete \Build when rebuilding from scratch).

\Build\Release
	This directory contains only the files needed in a standalone release of Microcosm. Extra work may be needed to get this directory fully populated. For example, during a build class files may be generated into, say, \Build\steward\classes. But they are not put into \Build\Release. There is a separate build step to zip up all the classes needed a release and put them in one big zipfile in \Build\Release.
	There are a couple of reasons for this two stage process. Firstly, there are many temporary files generated during a build and it doesn't make sense to put them in \Build\Release, where they would clutter up the release. Secondly, developers don't need a self contained release at all times. They have the build environment installed and the extra effort of zipping and copying everything into \Build\Release would be a waste when they can just pick things up from \EC. However, if a developer hands off a release to someone else they should first do the extra work to set up \Build\Release properly (see Building a Release for more details).

## Common make Targets

When rebuilding the system, you should usually build in \src. The top level makefile in \src has many useful targets. You can get a list of these targets by going into \src and typing make. You'll get the following message:

Please specify a set of make targets. Select no more than one per category.

'everything' : build all sources
'cosm' : just perform a build in cosm1
'objects' : just perform a build in cosm1/objects
'nobuild' : do not build
'firstparty' : build all sources and populate /Build/FP
(firstparty builds must be done within a release environment)

'release' : Populate /Build/Release with HabiTurf items
'hub-release' : release + add hub-related items to /Build/Release

'ec-zipclasses' : Create zipfile from classes in /EC
'build-zipclasses' : Create zipfile from classes in /Build and /EC/TP
'zipclasses' : Create zipfile from classes in /EC/TP, EC/FP & /Build

'makerep' : make a repository
'getrep' : get repository from /home/eng/media
'norep' : don't get or create a repository

Examples:

Typical: make nobuild release getrep
Full: make everything hub-release build-zipclasses makerep

