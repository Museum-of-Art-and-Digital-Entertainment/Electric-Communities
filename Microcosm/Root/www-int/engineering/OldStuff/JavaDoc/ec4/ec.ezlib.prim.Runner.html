<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<!--NewPage-->
<html>
<head>
<!-- Generated by javadoc on Wed May 20 22:30:26 PDT 1998 -->
<title>
  Class ec.ezlib.prim.Runner
</title>
</head>
<body>
<a name="_top_"></a>
<pre>
<a href="packages.html">All Packages</a>  <a href="tree.html">Class Hierarchy</a>  <a href="Package-ec.ezlib.prim.html">This Package</a>  <a href="ec.ezlib.prim.Queue.html#_top_">Previous</a>  <a href="ec.ezlib.prim.ScriptMaker.html#_top_">Next</a>  <a href="AllNames.html">Index</a></pre>
<hr>
<h1>
  Class ec.ezlib.prim.Runner
</h1>
<pre>
<a href="java.lang.Object.html#_top_">java.lang.Object</a>
   |
   +----ec.ezlib.prim.Runner
</pre>
<hr>
<dl>
  <dt> public class <b>Runner</b>
  <dt> extends <a href="java.lang.Object.html#_top_">Object</a>
  <dt> implements <a href="java.lang.Runnable.html#_top_">Runnable</a>
</dl>
Runs when it can, but never on empty.  A thread services a queue
 of Runnables.
<p>
<hr>
<a name="index"></a>
<h2>
  <img src="images/variable-index.gif" width=207 height=38 alt="Variable Index">
</h2>
<dl>
  <dt> <img src="images/magenta-ball-small.gif" width=6 height=6 alt=" o ">
	<a href="#myVatLock"><b>myVatLock</b></a>
  <dd>  "protected" so subclasses can wait on this in their own way

 
  <dt> <img src="images/blue-ball-small.gif" width=6 height=6 alt=" o ">
	<a href="#tr"><b>tr</b></a>
  <dd> 
</dl>
<h2>
  <img src="images/constructor-index.gif" width=275 height=38 alt="Constructor Index">
</h2>
<dl>
  <dt> <img src="images/yellow-ball-small.gif" width=6 height=6 alt=" o ">
	<a href="#Runner()"><b>Runner</b></a>()
  <dd>  Makes a Runner, and starts the thread that services its queue.
</dl>
<h2>
  <img src="images/method-index.gif" width=207 height=38 alt="Method Index">
</h2>
<dl>
  <dt> <img src="images/red-ball-small.gif" width=6 height=6 alt=" o ">
	<a href="#callNow(java.lang.Object, java.lang.String, java.lang.Object[])"><b>callNow</b></a>(Object, String, Object[])
  <dd>  Does a now() around the equivalent of <p>
 "E.call(rec, verb, args)".
  <dt> <img src="images/red-ball-small.gif" width=6 height=6 alt=" o ">
	<a href="#disturbEvent(java.lang.Throwable)"><b>disturbEvent</b></a>(Throwable)
  <dd>  Performs a Thread.stop(t) on the thread executing the current
 event.
  <dt> <img src="images/red-ball-small.gif" width=6 height=6 alt=" o ">
	<a href="#enqueue(java.lang.Runnable)"><b>enqueue</b></a>(Runnable)
  <dd>  Queue's something for this Runnable's thread to do.
  <dt> <img src="images/red-ball-small.gif" width=6 height=6 alt=" o ">
	<a href="#now(ec.ezlib.base.Thunk)"><b>now</b></a>(Thunk)
  <dd>  Executes the 'todo' Thunk "inside" this vat, ie, while holding
 this vat's vatLock.
  <dt> <img src="images/green-ball-small.gif" width=6 height=6 alt=" o ">
	<a href="#optCurrentRunner()"><b>optCurrentRunner</b></a>()
  <dd>  If called from within a thread servicing a Runner, returns that
 runner.
  <dt> <img src="images/red-ball-small.gif" width=6 height=6 alt=" o ">
	<a href="#orderlyShutdown()"><b>orderlyShutdown</b></a>()
  <dd>  Will enqueue a request to shut down this vat's thread.
  <dt> <img src="images/red-ball-small.gif" width=6 height=6 alt=" o ">
	<a href="#run()"><b>run</b></a>()
  <dd>  Called only by Thread.start().
  <dt> <img src="images/green-ball-small.gif" width=6 height=6 alt=" o ">
	<a href="#setDefaultRunner(ec.ezlib.prim.Runner)"><b>setDefaultRunner</b></a>(Runner)
  <dd>  Determines which runner is returned if optCurrentRunner() is
 called from a thread other than the one servicing a Runner
 queue.
  <dt> <img src="images/red-ball-small.gif" width=6 height=6 alt=" o ">
	<a href="#waitForMore()"><b>waitForMore</b></a>()
  <dd>  Called by run() when we're out of messages in the queue,
 or after the debug hook does its biz.
</dl>
<a name="variables"></a>
<h2>
  <img src="images/variables.gif" width=153 height=38 alt="Variables">
</h2>
<a name="tr"><img src="images/blue-ball.gif" width=12 height=12 alt=" o "></a>
<b>tr</b>
<pre>
 public static <a href="ec.trace.Trace.html#_top_">Trace</a> tr
</pre>
<a name="myVatLock"><img src="images/magenta-ball.gif" width=12 height=12 alt=" o "></a>
<b>myVatLock</b>
<pre>
 protected <a href="java.lang.Object.html#_top_">Object</a> myVatLock
</pre>
<dl>
  <dd> "protected" so subclasses can wait on this in their own way<p>
  <dd><dl> 
    <dt> <b>See Also:</b>
    <dd> <a href="#waitForMore">waitForMore</a>
  </dl></dd>
</dl>
<a name="constructors"></a>
<h2>
  <img src="images/constructors.gif" width=231 height=38 alt="Constructors">
</h2>
<a name="Runner"></a>
<a name="Runner()"><img src="images/yellow-ball.gif" width=12 height=12 alt=" o "></a>
<b>Runner</b>
<pre>
 public Runner()
</pre>
<dl>
  <dd> Makes a Runner, and starts the thread that services its queue.
<p>
</dl>
<a name="methods"></a>
<h2>
  <img src="images/methods.gif" width=151 height=38 alt="Methods">
</h2>
<a name="setDefaultRunner(ec.ezlib.prim.Runner)"><img src="images/green-ball.gif" width=12 height=12 alt=" o "></a>
<a name="setDefaultRunner"><b>setDefaultRunner</b></a>
<pre>
 public static void setDefaultRunner(<a href="#_top_">Runner</a> optRunner)
</pre>
<dl>
  <dd> Determines which runner is returned if optCurrentRunner() is
 called from a thread other than the one servicing a Runner
 queue.  If 'optRunner' is null, then optCurrentRunner() will
 return null in this case.
<p>
</dl>
<a name="optCurrentRunner()"><img src="images/green-ball.gif" width=12 height=12 alt=" o "></a>
<a name="optCurrentRunner"><b>optCurrentRunner</b></a>
<pre>
 public static <a href="#_top_">Runner</a> optCurrentRunner()
</pre>
<dl>
  <dd> If called from within a thread servicing a Runner, returns that
 runner.  Otherwise, returns the default runner or null, as set by
 setDefaultRunner().
<p>
</dl>
<a name="enqueue(java.lang.Runnable)"><img src="images/red-ball.gif" width=12 height=12 alt=" o "></a>
<a name="enqueue"><b>enqueue</b></a>
<pre>
 public void enqueue(<a href="java.lang.Runnable.html#_top_">Runnable</a> todo)
</pre>
<dl>
  <dd> Queue's something for this Runnable's thread to do.  May be called
 from any thead.
<p>
</dl>
<a name="orderlyShutdown()"><img src="images/red-ball.gif" width=12 height=12 alt=" o "></a>
<a name="orderlyShutdown"><b>orderlyShutdown</b></a>
<pre>
 public void orderlyShutdown()
</pre>
<dl>
  <dd> Will enqueue a request to shut down this vat's thread.  Since
 this is an enqueued request, the thread will only shut down
 after finishing earlier requests, as well as any now()s that
 happen in the meantime.  For a more violent approach, see
 disturbEvent().
<p>
</dl>
<a name="run()"><img src="images/red-ball.gif" width=12 height=12 alt=" o "></a>
<a name="run"><b>run</b></a>
<pre>
 public void run()
</pre>
<dl>
  <dd> Called only by Thread.start().  (XXX It's a modularity bug for
 this to be public.) Pulls Runnables off of the queue until
 there aren't any more, then waits until there's more to do.
<p>
</dl>
<a name="waitForMore()"><img src="images/red-ball.gif" width=12 height=12 alt=" o "></a>
<a name="waitForMore"><b>waitForMore</b></a>
<pre>
 protected void waitForMore() throws <a href="java.lang.InterruptedException.html#_top_">InterruptedException</a>
</pre>
<dl>
  <dd> Called by run() when we're out of messages in the queue,
 or after the debug hook does its biz.  Must be called while
 myVatLock is held.  <p>
 May be overridden in a subclass to wake up occasionally to do
 background things, like checking for finalizers.  The implementation
 here simply wait()s on myVatLock.
<p>
</dl>
<a name="now(ec.ezlib.base.Thunk)"><img src="images/red-ball.gif" width=12 height=12 alt=" o "></a>
<a name="now"><b>now</b></a>
<pre>
 public <a href="java.lang.Object.html#_top_">Object</a> now(<a href="ec.ezlib.base.Thunk.html#_top_">Thunk</a> todo) throws <a href="java.lang.Throwable.html#_top_">Throwable</a>
</pre>
<dl>
  <dd> Executes the 'todo' Thunk "inside" this vat, ie, while holding
 this vat's vatLock.  This is all synchronous -- todo is
 executed by the calling thread, as opposed to the vat's
 thread.  (Of course, the two may be the same.)  If someone
 calls disturbEvent() on this Runner while the now() is in
 progress, now()'s calling thread gets stop()ped, rather than
 the vat's thread. <p>
 The outcome (return result or thrown exception) of now() is the
 outcome of run()ning 'todo'.
<p>
  <dd><dl>
    <dt> <b>See Also:</b>
    <dd> <a href="java.lang.Thread.html#stop">stop</a>
  </dl></dd>
</dl>
<a name="callNow(java.lang.Object, java.lang.String, java.lang.Object[])"><img src="images/red-ball.gif" width=12 height=12 alt=" o "></a>
<a name="callNow"><b>callNow</b></a>
<pre>
 public <a href="java.lang.Object.html#_top_">Object</a> callNow(<a href="java.lang.Object.html#_top_">Object</a> rec,
                       <a href="java.lang.String.html#_top_">String</a> verb,
                       <a href="java.lang.Object.html#_top_">Object</a> args[]) throws <a href="java.lang.Throwable.html#_top_">Throwable</a>
</pre>
<dl>
  <dd> Does a now() around the equivalent of <p>
 "E.call(rec, verb, args)". <p>
 The outcome of callNow() is the outcome of E.call().
<p>
</dl>
<a name="disturbEvent(java.lang.Throwable)"><img src="images/red-ball.gif" width=12 height=12 alt=" o "></a>
<a name="disturbEvent"><b>disturbEvent</b></a>
<pre>
 public void disturbEvent(<a href="java.lang.Throwable.html#_top_">Throwable</a> t)
</pre>
<dl>
  <dd> Performs a Thread.stop(t) on the thread executing the current
 event.  This will usually be the vat thread (the one servicing
 the Runner queue), but when a now() or callNow() is in
 progress, the calling thread gets stop()ped instead.  Note that
 Thread.stop() does not stop the thread (obvious huh?), but
 rather causes that thread to experience a "spontaneously"
 thrown exception.
<p>
  <dd><dl>
    <dt> <b>See Also:</b>
    <dd> <a href="java.lang.Thread.html#stop">stop</a>
  </dl></dd>
</dl>
<hr>
<pre>
<a href="packages.html">All Packages</a>  <a href="tree.html">Class Hierarchy</a>  <a href="Package-ec.ezlib.prim.html">This Package</a>  <a href="ec.ezlib.prim.Queue.html#_top_">Previous</a>  <a href="ec.ezlib.prim.ScriptMaker.html#_top_">Next</a>  <a href="AllNames.html">Index</a></pre>
</body>
</html>
